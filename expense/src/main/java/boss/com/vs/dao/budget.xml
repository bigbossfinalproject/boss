<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="boss.com.vs.model.BudgetBean"> 

 	<!-- 예산 목록  -->  
	 <select id="budget_list" parameterType="String" resultType="budget">
		select * from budget where to_char(budget_date,'YYYY-MM')=#{budget_date}
	</select>
	<!-- 예산 엑셀 목록  -->  
	 <select id="budget_excel_list" parameterType="String" resultType="budget">
		select * from budget 
	</select>
	
	
	<!-- 예산 중복 확인  -->  
	 <select id="insert_check" parameterType="String" resultType="int">
			select count(*) from budget where to_char(budget_date,'YYYY-MM')=to_char(sysdate,'YYYY-MM') and ITEM_code=#{item_code}
	</select>

	<!-- 통합 예산 목록 -->
	<select id="budget_total_list" resultType="budget">
	select sum(budget_amount) budget_amount, sum(budget_amount_spent) budget_amount_spent,to_char(budget_date,'YYYYMM') budget_date from budget group by to_char(budget_date,'YYYYMM')
	</select>
	<!-- 아이템 리스트 -->
	<select id="item_list" resultType="String">
	select item_name from item
	</select>
	
	<!-- 예산 등록 -->
 <insert id="budget_insert" parameterType="budget">
	 insert into budget 
	 values(budget_code_seq.nextVal,1,#{budget_amount}, 
	 0,sysdate,#{item_code})         
	</insert>
	<!-- 예산 복사 -->
 <insert id="budget_copy" parameterType="budget">
	 insert into budget 
	 values(budget_code_seq.nextVal,#{root_idn},#{budget_amount}, 
	 0,sysdate,#{item_code})         
	</insert>
	
	
	
 
 	<!-- 예산 삭제 -->
 <delete id="budget_delete" parameterType="int">
 	delete from budget where budget_code =#{budget_code}
 </delete>	
 
 
 	<!-- 예산 수정 -->
 	<update id="budget_modify" parameterType="budget">
		update budget set BUDGET_AMOUNT = #{budget_amount}, item_code=#{item_code},budget_amount_spent=#{budget_amount_spent} 
		where budget_code=#{budget_code}
	</update>

	<!-- 예산에서 세부항목 개수 가져오기 -->
	<select id="budgetItemCount" parameterType="java.util.Map" resultType="int">
		select count(*) from budget where item_code <![CDATA[=]]> #{item_code}
	</select>



</mapper>


	
